
<div class="space-y-4">
  <div class="flex items-center justify-between">
    <h2 class="text-xl font-semibold">Results for: <span class="text-slate-600">{{ query }}</span></h2>
    <div class="text-xs text-slate-500">
      {% if include_domains %}Including: {{ include_domains|join(", ") }} · {% endif %}
      {% if exclude_domains %}Excluding: {{ exclude_domains|join(", ") }} · {% endif %}
      {% if recency_days and recency_days > 0 %}Since last {{ recency_days }} day(s){% else %}Any time{% endif %}
    </div>
  </div>

  {% if results|length == 0 %}
    <div class="p-6 bg-amber-50 border border-amber-200 rounded-xl text-amber-800">No results from Exa.</div>
  {% endif %}

  <ul class="space-y-4">
    {% for r in results %}
      <li class="border border-slate-200 rounded-2xl p-4 bg-white shadow-sm">
        <div class="flex items-start justify-between gap-4">
          <div>
            <a href="{{ r.url }}" target="_blank" class="font-semibold text-blue-700 hover:underline">{{ r.title or r.url }}</a>
            <div class="text-xs text-slate-500 mt-1">{{ r.domain }} {% if r.published_date %}• {{ r.published_date }}{% endif %}</div>
          </div>
          <form hx-post="/similar" hx-target="#sim-{{ loop.index }}" hx-swap="innerHTML">
            <input type="hidden" name="url" value="{{ r.url }}">
            <input type="hidden" name="q" value="{{ query }}">
            <button class="text-sm border rounded-lg px-3 py-1 hover:bg-slate-50">Find similar</button>
          </form>
        </div>

        {% if r.highlights %}
          <div class="text-sm mt-3 space-y-2">
            {% for h in r.highlights %}
              <p class="bg-slate-50 border border-slate-200 rounded-lg p-2">{{ h }}</p>
            {% endfor %}
          </div>
        {% endif %}

        {% if r.text %}
          <details class="mt-3">
            <summary class="cursor-pointer text-sm text-slate-600">View extracted text</summary>
            <pre class="whitespace-pre-wrap text-sm mt-2">{{ r.text[:2000] }}{% if r.text|length > 2000 %}…{% endif %}</pre>
          </details>
        {% endif %}

        <div id="sim-{{ loop.index }}" class="mt-3"></div>
      </li>
    {% endfor %}
  </ul>
</div>
